{% extends "base.html" %}
{% load s3 %}
{% load human_time %}
{% load show_error %}
{% load emoticons_tags %}
{% load get_group_button %}
{% block content %}
<head><title>{% if switching %}Private mehfil{% else %}{{ group_topic }} (private mehfil){% endif %} | Damadam.pk</title></head>
<style>body{background:#f0f3f4}</style>

<div class="mbl" style="max-width: 600px;margin-left: auto;margin-right:auto;text-align:center;overflow:hidden">
    <h1 style="display:inline" class="clb cxl lsp">{% if switching %}Mehfil not found{% else %}{% emoticons %}{{ group_topic }}{% endemoticons %}{% endif %}:</h1>
</div>

<div class="mbl clb" style="border:3px solid #ececec;border-radius:12px;padding:10px 8px;max-width:600px;width:96%;overflow:hidden;background:white;margin-right:auto;margin-left:auto">

{% if switching %}
    <div style="text-align:center">
    <div class="cxl lsp" style="text-align:center">Ye mehfil dar ke bhag geyi hai...</div>
    <hr size=1 COLOR="#E9EBEE">
    <div class="sp lsp cgy mbl">Hum isey pakarne ki koshish krein ge</div>
    <a href="{% url 'group_page' %}#section0" class="cgy cl sp" style="border-bottom:1px dotted darkgray">wapis</a>
    </div><br>
{% elif full_member %}
    <a name="sectionJ"></a>

    <div id="grp_img_size_err" class="mbs" style="text-align:left;display:none"><span class="cr lsp">Ye foto buhut barri hai, choti foto chunein</span></div>
    <div id="grp_img_mime_err" class="mbs" style="text-align:left;display:none"><span class="cr lsp">Ye foto kharab hai, koi aur chunein</span></div>
    <form action="{% url 'private_group_reply' %}" id="grp_form" method="POST" class="mbl" enctype="multipart/form-data" style="display:inline;">
        {% csrf_token %}
        <input type="hidden" name="unique" value="{{ unique }}">
        <input id="grp_sk" type="hidden" name="sk" value="{{ sk }}">
        <input id="grp_wid" type="hidden" name="wid" value="-1">
       <b class="sp cs">Upload foto:</b>
       <div class="mt">{{ form.image }}</div>
        {% if on_fbs %}<div class="mt cgy cs">Freebasics pe <b>200 KB</b> se barri pic nahi lagti</div>{% endif %}
        <div class="mtl sp">{% if form.errors %}<span class="cr lsp">{{ form.errors|show_error }}</span>{% else %}<b class="cs">Message likhein:</b>{% endif %}</div>
        <div class="mt">{{ form.text }}</div>
    <button class="mts mbs btn bm bcg mrl pg_ok_res" id="grp_subform" type="submit" name="gp" style="height:28px" value="{{ group_id }}">OK</button>
    </form>&nbsp;
    <form action="{% url 'first_time_refresh' unique %}" class="mbl" method="POST" enctype="multipart/form-data" style="display:inline;">
        {% csrf_token %}
        <button class="rf rf-bg" style="background-image: url({{ STATIC_URL }}img/refresh.svg);vertical-align:middle;width:23px;height:23px" type="submit"></button>
    </form>

    {% include "mehfil/private_group_navbar.html" with uuid=unique gid=group_id static_url=STATIC_URL %}

    {% for reply,status in replies %}

        {% if not on_fbs and forloop.counter == 3 %}
            <div style="text-align:center;background:snow">
                <ins class="adsbygoogle"
                    style="display:inline-block;vertical-align: middle;width:320px;height:100px"
                    data-ad-client="ca-pub-2568547635306983"
                    data-ad-slot="4784035315"></ins>
                <script>
                (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
            </div>
            <hr size=1 COLOR="#f4f4f4">
        {% endif %}

        {% if reply.category == '1' %}
            <div class="lsp sp cs" style="overflow:hidden"><span class="cgy"><bdi><b class="clb">{{ reply.writer_uname }}</b> ne <bdi><span class="clb" style="font-weight:bold">{{ reply.text }}</span></bdi> ko invite kia</span></div>
        {% elif reply.category == '2' %}
            <div class="lsp sp cs" style="overflow:hidden"><span class="cgy"><bdi><a href="{% url 'profile' reply.text 'fotos' %}" class="clb" style="font-weight:bold">{{ reply.text }}</a></bdi> ko mehfil se kick out kar dia gya</span></div>
        {% elif reply.category == '3' %}
            <div class="lsp sp cs mrl" style="display:inline"><span class="cgy"><bdi><b class="clb">{{ reply.writer_uname }}</b></bdi> ki baat hide kar di geyi</span></div>
            <form method="POST" action="{% url 'private_group_hide_submission' %}" style="display:inline">
            {% csrf_token %}
            <input type="hidden" name="dec" value="u">
            <input type="hidden" name="gid" value="{{ group_id }}">
            <button type="submit" name="pk" class="mt pg_ok_res mrs" value="{{ reply.id }}" style="background:0 0;border:none;padding:0"><img src="{{ STATIC_URL }}img/restore.svg" width="18" height="18" style="vertical-align:sub"></button>
            </form>
        {% elif reply.category == '4' %}
            <div class="lsp sp cs" style="overflow:hidden"><span class="cgy"><bdi><b class="clb">{{ reply.writer_uname }}</b></bdi> ne new topic rakha: <b class="clb"><bdi>{% emoticons %}{{ reply.text }}{% endemoticons %}</bdi></b></span></div>
        {% elif reply.category == '6' %}
            <div class="lsp sp cs" style="overflow:hidden"><span class="cgy"><bdi><a href="{% url 'profile' reply.writer_uname 'fotos' %}" class="clb" style="font-weight:bold">{{ reply.writer_uname }}</a></bdi> ne mehfil se exit kia</span></div>
        {% elif reply.category == '7' %}
            <div class="lsp sp cs" style="overflow:hidden"><span class="cgy"><bdi><a href="{% url 'profile' reply.writer_uname 'fotos' %}" class="clb" style="font-weight:bold">{{ reply.writer_uname }}</a></bdi> ne mehfil ka invite reject kia</span></div>
        {% elif reply.category == '8' %}
            <div class="lsp sp cs" style="overflow:hidden"><span class="cgy"><bdi><b class="clb">{{ reply.writer_uname }}</b></bdi> ne mehfil ka new owner <bdi><a href="{% url 'profile' reply.text 'fotos' %}" class="clb" style="font-weight:bold">{{ reply.text }}</a></bdi> ko bana dia</span></div>
        {% elif reply.category == '9' %}
            <div class="lsp sp cs" style="overflow:hidden"><span class="cgy"><bdi><a href="{% url 'profile' reply.writer_uname 'fotos' %}" class="clb" style="font-weight:bold">{{ reply.writer_uname }}</a></bdi> ne mehfil join ki</span></div>
        {% elif reply.category == '10' %}
            <div class="lsp sp cs" style="overflow:hidden"><span class="cgy"><bdi><a href="{% url 'profile' reply.writer_uname 'fotos' %}" class="clb" style="font-weight:bold">{{ reply.writer_uname }}</a></bdi> inactivity ki wajah se exit ho gya</span></div>
        {% else %}
            {% if reply.image %}
            <div style="text-align:center"><img src="{{ reply.image|s3 }}" style="border-radius:12px;max-width:100%" alt="foto"></div>
            {% endif %}

            {% if reply.wid == own_id|slugify %}
            <div class="lsp" style="overflow:hidden;background:ivory">
            {% else %}
            <div class="lsp" style="overflow:hidden">
            {% endif %}

            {% if status == 'green' %}
                <div class="st-dot" style="background-color:#00FF00;border:2px solid #00F200;"></div>
            {% elif status == 'idle' %}
                <div class="st-dot" style="background-color:#9BE29B;border:2px solid #91DF91;"></div>
            {% else %}
                <div class="st-dot" style="background-color:#C8C8C8;border:2px solid #C4C4C4;"></div>
            {% endif %}
        
                {% if unseen %}
                    {% if not reply_time or reply.submitted_on > reply_time %}
                    <div class="sp cxs mrs" style="background-color:orange;color:white;padding:3px 6px;border-radius:3px;display:inline;vertical-align:super">NEW</div>
                    {% endif %}
                {% endif %}
        
            <a href="{% url 'profile' reply.writer_uname 'fotos' %}#section0" class="clb cm sp" style="font-weight:bold"><img src="{{ reply.writer_avurl }}" style="border-radius:50%" alt="pic">{% if reply.writer_uname in ensured %}&nbsp;<img src="{{ STATIC_URL }}img/pstar.svg" width="11" height="11" alt="*" style="color:deeppink">{% endif %}&nbsp;<bdi>{{ reply.writer_uname }}</bdi></a>:&nbsp;{% if reply.tu %}<b>@&nbsp;</span>{{ reply.tu }}&nbsp;-&nbsp;</b>{% endif %}<span class="bw cl"><bdi>{% emoticons %}{{ reply.text }}{% endemoticons %}</bdi></span>

            <span class="sp cgy cxs mrl">&nbsp;{{ reply.submitted_on|human_time }}</span>

            <button name="wid" style="display:{{ display }};background:0 0;border:none;padding:0" class="at pg_ok_res mrs" value="{{ reply.wid }}"><img src="{{ STATIC_URL }}img/at.svg" width="15" height="15" class="mrs" style="vertical-align:sub"></button>

            <form method="POST" action="{% url 'private_group_hide_submission' %}" style="display:inline">
            {% csrf_token %}
            <input type="hidden" name="dec" value="h">
            <input type="hidden" name="gid" value="{{ group_id }}">
            <button type="submit" name="pk" class="mt pg_ok_res mrs" value="{{ reply.id }}" style="background:0 0;border:none;padding:0"><img src="{{ STATIC_URL }}img/report_dark.svg" width="16" height="16" style="vertical-align:sub"></button>
            </form>

            {% group_button own_id=own_id target_id=reply.wid parent_object_id=unique object_type='group' origin='15' target_username=reply.writer_uname %}
            </div>
        {% endif %}
            
            <hr size=1 COLOR="#f4f4f4">

        {% endfor %}

{% else %}

    <a name="sectionJ"></a>  

     <div class="bizcard mbs lsp cl sp" style="background-color:ivory;padding:10px;text-align:center">

        <form class="mbl" method="POST" action="{% url 'join_private_group' %}">
            {% csrf_token %}
            <div>Is mehfil ke member banney ke liye 'JOIN' dabain:</div>
            <button name="gid" type="submit" class="btn bxl sp pg_ok_res mtl" style="background-color:#19a83b;height:26px;font-weight:bold" value="{{ group_id }}">JOIN</button>
        </form>
        <div class="cs sp" style="border-top:1px dashed lightgray;padding-top:10px"><span class="cgy"><b>Note:</b> Join karney ke baad apko kam az kam {{ exit_wait_time }} tak member rehna ho ga</span></div>
    </div>

    {% if not on_fbs %}
    <div style="text-align:center;background:snow;">
        <ins class="adsbygoogle"
            style="display:inline-block;vertical-align: middle;width:320px;height:100px"
            data-ad-client="ca-pub-2568547635306983"
            data-ad-slot="4784035315"></ins>
        <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
    </div>
    {% endif %}

    
{% endif %}
</div>
<br><br>
<input type="hidden" id="furl" name="furl" value="{{ furl }}">
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script async type="text/javascript" src="{{ STATIC_URL }}js/module/helper_funcs.v1.13.js"></script>
{% endblock %}